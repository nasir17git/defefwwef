name: Slack Notification
run-name: 🛠️ 빌드 - 1. ${{ github.ref_name }} 2. ${process.env.AS_MESSAGE} 3. by ${{ github.actor }}

on:
  push:
  workflow_dispatch:
    inputs:
      print_tags:
        description: 'True to print to STDOUT'
        required: true
        type: boolean
      tags:
        description: 'Test scenario tags'
        required: true
        type: string
      environment:
        description: 'Environment to run tests against'
        type: environment
        required: true
jobs:
  notify:
    name: Post to Slack
    runs-on: ubuntu-latest
    # services:
    #   mongodb:
    #     image: mongo:4.2
    #     ports:
    #       - 27017:27017
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      # - name: AWS login
      #   uses: aws-actions/configure-aws-credentials@v2
      #   with:
      #     aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
      #     aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
      #     aws-region: ap-northeast-2

      # - name: Get Short SHA
      #   run: |
      #     echo "GITHUB_SHA_SHORT=${GITHUB_SHA::7}" >> $GITHUB_ENV

      # - name: Setup MySQL
      #   uses: mirromutth/mysql-action@v1.1
      #   with: 
      #     mysql version: 5.7.12
      #     mysql database: lendit_test
      #     mysql user: aaa
      #     mysql password: aaa

      # - name: Start MongoDB
      #   uses: supercharge/mongodb-github-action@1.8.0
      #   with:
      #     mongodb-version: '4.2'
      # - name: Use Node.js
      #   uses: actions/setup-node@v3
      #   with:
      #     node-version: 16.x
      - name: Start MongoDB
        uses: supercharge/mongodb-github-action@1.8.0
        with:
          mongodb-version: 4.2
  
      # - name: version check
      #   run: | 
      #     docker ps -a
      #     mongo
      #     curl 127.0.0.1:27017
  
      # - run: npm install
  
      # - run: npm test
      #   env:
      #     CI: true

      # - name: Post to Slack channel
      #   id: slack
      #   uses: slackapi/slack-github-action@v1.24.0
      #   with:
      #     channel-id: 'C05J50BRRB3'  # Replace with your Slack channel ID or name

      #     payload: |
      #       {
      #         "text": "GitHub Action build result: ${{ job.status }}\n${{ github.event.pull_request.html_url || github.event.head_commit.url }} \n 2.${{ github.sha }} 3.${{ env.SHA8 }} 3.5. ${{ secrets.GITHUB_TOKEN }} 4. ${{ env.GITHUB_SHA_SHORT}}",
      #         "attachments": [
      #           {
      #             "color": "#a63636",
      #             "blocks": [
      #               {
      #                 "type": "section",
      #                 "text": {
      #                   "type": "mrkdwn",
      #                   "text": "msg"
      #                 }
      #               }
      #             ]
      #           }
      #         ]
      #       }

      #   env:
      #     SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
